<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Magpie Arts | Shop</title>
  <style>
    body {
      font-family: 'Candara', Arial, sans-serif;
      background: #f5f9ff;
      margin: 0; padding: 30px 20px;
      color: #222;
    }
    h1 {
      text-align: center;
      font-family: 'Roboto Serif', serif;
      font-weight: 900;
      font-size: 2.8rem;
      margin-bottom: 2rem;
      color: #253060;
    }
    .products-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 1.8rem;
      max-width: 1200px;
      margin: 0 auto;
      justify-content: center;
    }
    .product-card {
      background: white;
      border-radius: 14px;
      box-shadow: 0 3px 15px rgba(65,105,225,0.1);
      flex: 1 1 280px;
      max-width: 300px;
      cursor: pointer;
      transition: box-shadow 0.3s ease;
      user-select: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 1rem;
    }
    .product-card:hover {
      box-shadow: 0 6px 28px rgba(41,164,254,0.35);
    }
    .product-img {
      width: 100%;
      height: 180px;
      object-fit: contain;
      border-radius: 12px;
      background-color: #e8f1ff;
      margin-bottom: 1rem;
    }
    .product-title {
      font-family: 'Candara', Arial, sans-serif;
      font-weight: 700;
      font-size: 1.25rem;
      color: #1b3a8d;
      margin-bottom: 0.3rem;
      text-align: center;
      min-height: 48px;
    }
    .product-price {
      font-size: 1.1rem;
      font-weight: 700;
      color: #1a237e;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Shop Our Products</h1>
  <div class="products-grid" id="productsGrid">
    <!-- Products rendered here dynamically -->
  </div>

  <script>
    // Load products data from localStorage (added in admin.html)
    const products = JSON.parse(localStorage.getItem('magpieProducts')) || [];

    const productsGrid = document.getElementById('productsGrid');

    // Function to get starting price for each product (lowest price among all combos)
    function getStartingPrice(prod) {
      const prices = [
        prod.priceS1C16,
        prod.priceS1C20,
        prod.priceS2C20,
        prod.priceS2C24
      ].filter(p => typeof p === 'number' && p > 0);
      if (prices.length === 0) return "N/A";
      return Math.min(...prices);
    }

    // Render all products into the grid
    function renderProducts() {
      if (products.length === 0) {
        productsGrid.innerHTML = '<p style="font-size:1.2rem; text-align:center; width:100%;">No products available. Please add products in the admin panel.</p>';
        return;
      }
      productsGrid.innerHTML = '';
      products.forEach((prod, i) => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.onclick = () => openProductPage(i);
        card.innerHTML = `
          <img src="${prod.image}" alt="${prod.title}" class="product-img" loading="lazy" />
          <div class="product-title">${prod.title}</div>
          <div class="product-price">Starting at Rs. ${getStartingPrice(prod).toLocaleString()}</div>
        `;
        productsGrid.appendChild(card);
      });
    }

    // Placeholder function to open product detail page (can be enhanced)
    function openProductPage(index) {
      alert('Open detail page for product: ' + products[index].title);
      // Future enhancement: Navigate to detailed product page with product data
      // e.g., window.location.href = `product-detail.html?index=${index}`;
    }

    renderProducts();
  </script>
</body>
</html>
